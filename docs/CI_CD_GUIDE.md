# CI/CD è‡ªåŠ¨åŒ–æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®å·²é…ç½®å®Œæ•´çš„ GitHub Actions CI/CD æµç¨‹ï¼Œæ”¯æŒï¼š
- âœ… è‡ªåŠ¨æ„å»ºå’Œæµ‹è¯•
- âœ… PR è‡ªåŠ¨æ£€æŸ¥
- âœ… è‡ªåŠ¨å‘å¸ƒå’Œæ‰“åŒ…

## ğŸš€ GitHub Actions Workflows

### 1. CI Workflow (`ci.yml`)

**è§¦å‘æ¡ä»¶ï¼š**
- Push åˆ° `main`, `master`, `develop` åˆ†æ”¯
- Pull Request åˆ°è¿™äº›åˆ†æ”¯

**æ‰§è¡Œæ­¥éª¤ï¼š**
1. âœ… Checkout ä»£ç 
2. âœ… è®¾ç½® JDK 11 ç¯å¢ƒ
3. âœ… éªŒè¯ Maven é¡¹ç›®
4. âœ… ç¼–è¯‘æ’ä»¶
5. âœ… è¿è¡Œæµ‹è¯•
6. âœ… æ‰“åŒ…æ’ä»¶
7. âœ… éªŒè¯æ’ä»¶æ–‡ä»¶
8. âœ… æ£€æŸ¥æ‰©å±•ç‚¹ç´¢å¼•
9. âœ… ä¸Šä¼ æ„å»ºäº§ç‰©

**æŸ¥çœ‹æ–¹å¼ï¼š**
```bash
https://github.com/zsjohny/jenkins-scheduled-build-plugin/actions
```

### 2. PR Check Workflow (`pr-check.yml`)

**è§¦å‘æ¡ä»¶ï¼š**
- Pull Request æ‰“å¼€ã€åŒæ­¥æˆ–é‡æ–°æ‰“å¼€æ—¶

**æ‰§è¡Œæ­¥éª¤ï¼š**
1. âœ… ä»£ç æ ¼å¼æ£€æŸ¥
2. âœ… ç¼–è¯‘æ£€æŸ¥
3. âœ… ä¾èµ–åˆ†æ
4. âœ… éªŒè¯æ‰©å±•ç‚¹
5. âœ… æ£€æŸ¥èµ„æºæ–‡ä»¶
6. âœ… æ‰“åŒ…æµ‹è¯•
7. âœ… éªŒè¯æ’ä»¶å®Œæ•´æ€§
8. âœ… ç”Ÿæˆæ£€æŸ¥æ€»ç»“

**PR ç¤ºä¾‹ï¼š**
å½“æ‚¨åˆ›å»º PR æ—¶ï¼Œä¼šè‡ªåŠ¨è¿è¡Œæ‰€æœ‰æ£€æŸ¥å¹¶åœ¨ PR é¡µé¢æ˜¾ç¤ºç»“æœã€‚

### 3. Release Workflow (`release.yml`)

**è§¦å‘æ¡ä»¶ï¼š**
- Push å¸¦æœ‰ `v*` å‰ç¼€çš„ tagï¼ˆå¦‚ `v1.0.0`ï¼‰

**æ‰§è¡Œæ­¥éª¤ï¼š**
1. âœ… æ„å»ºå‘å¸ƒç‰ˆæœ¬
2. âœ… ç”Ÿæˆ Release è¯´æ˜
3. âœ… åˆ›å»º GitHub Release
4. âœ… è‡ªåŠ¨ä¸Šä¼  .hpi æ–‡ä»¶

## ğŸ“¦ å‘å¸ƒæ–°ç‰ˆæœ¬

### æ–¹æ³• 1ï¼šå‘½ä»¤è¡Œå‘å¸ƒ

```bash
# 1. ç¡®ä¿æ‰€æœ‰æ›´æ”¹å·²æäº¤
git add .
git commit -m "Release v1.0.0"

# 2. åˆ›å»ºå¹¶æ¨é€ tag
git tag -a v1.0.0 -m "Release version 1.0.0

æ–°åŠŸèƒ½:
- åŠŸèƒ½ A
- åŠŸèƒ½ B

ä¿®å¤:
- é—®é¢˜ 1
- é—®é¢˜ 2"

git push origin v1.0.0

# 3. GitHub Actions ä¼šè‡ªåŠ¨æ„å»ºå¹¶åˆ›å»º Release
```

### æ–¹æ³• 2ï¼šGitHub ç½‘é¡µå‘å¸ƒ

1. è®¿é—®ï¼šhttps://github.com/zsjohny/jenkins-scheduled-build-plugin/releases
2. ç‚¹å‡» "Draft a new release"
3. é€‰æ‹©æˆ–åˆ›å»º tagï¼ˆå¦‚ `v1.0.0`ï¼‰
4. å¡«å†™ Release æ ‡é¢˜å’Œè¯´æ˜
5. ç‚¹å‡» "Publish release"

## ğŸ” æŸ¥çœ‹æ„å»ºçŠ¶æ€

### æ„å»ºå¾½ç« 

åœ¨ README ä¸­æ·»åŠ ï¼š

```markdown
![CI](https://github.com/zsjohny/jenkins-scheduled-build-plugin/workflows/CI/badge.svg)
![Release](https://github.com/zsjohny/jenkins-scheduled-build-plugin/workflows/Release/badge.svg)
```

### æŸ¥çœ‹æ„å»ºæ—¥å¿—

1. è®¿é—®ï¼šhttps://github.com/zsjohny/jenkins-scheduled-build-plugin/actions
2. ç‚¹å‡»ä»»æ„ workflow è¿è¡Œ
3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—å’Œæ„å»ºäº§ç‰©

## ğŸ“¥ ä¸‹è½½æ„å»ºäº§ç‰©

### ä» Actions ä¸‹è½½

1. è®¿é—®æˆåŠŸçš„ CI è¿è¡Œ
2. åœ¨ "Artifacts" åŒºåŸŸä¸‹è½½ `scheduled-build-plugin`
3. è§£å‹è·å¾— `.hpi` æ–‡ä»¶

### ä» Releases ä¸‹è½½

1. è®¿é—®ï¼šhttps://github.com/zsjohny/jenkins-scheduled-build-plugin/releases
2. ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ `scheduled-build.hpi`

## ğŸ› ï¸ æœ¬åœ°æµ‹è¯• CI æµç¨‹

ä½¿ç”¨ [act](https://github.com/nektos/act) åœ¨æœ¬åœ°è¿è¡Œ GitHub Actionsï¼š

```bash
# å®‰è£… act
brew install act  # macOS
# æˆ–
curl https://raw.githubusercontent.com/nektos/act/master/install.sh | sudo bash

# è¿è¡Œ CI workflow
act push

# è¿è¡Œ PR check
act pull_request

# åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ workflows
act -l
```

## ğŸ”§ è‡ªå®šä¹‰ Workflows

### ä¿®æ”¹ CI é…ç½®

ç¼–è¾‘ `.github/workflows/ci.yml`ï¼š

```yaml
# ä¾‹å¦‚ï¼šæ·»åŠ ä»£ç è´¨é‡æ£€æŸ¥
- name: ä»£ç è´¨é‡æ£€æŸ¥
  run: mvn spotbugs:check
```

### æ·»åŠ  Secrets

å¦‚æœéœ€è¦ç§å¯†ä¿¡æ¯ï¼ˆå¦‚å‘å¸ƒå‡­è¯ï¼‰ï¼š

1. è®¿é—®ï¼šhttps://github.com/zsjohny/jenkins-scheduled-build-plugin/settings/secrets/actions
2. ç‚¹å‡» "New repository secret"
3. æ·»åŠ æ‰€éœ€çš„ secret
4. åœ¨ workflow ä¸­ä½¿ç”¨ï¼š`${{ secrets.YOUR_SECRET_NAME }}`

## ğŸ“Š å·¥ä½œæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¼€å‘è€…æäº¤   â”‚
â”‚   ä»£ç åˆ° PR   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PR Check   â”‚
â”‚  è‡ªåŠ¨è¿è¡Œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Merge PR   â”‚
â”‚  åˆ° main    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CI æ„å»º    â”‚
â”‚  è‡ªåŠ¨è¿è¡Œ    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åˆ›å»º tag   â”‚
â”‚  (v1.0.0)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Release    â”‚
â”‚  è‡ªåŠ¨å‘å¸ƒ    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  .hpi æ–‡ä»¶  â”‚
â”‚  å¯ä¾›ä¸‹è½½    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. åˆ†æ”¯ç­–ç•¥

- `main` - ä¸»åˆ†æ”¯ï¼ŒåªåŒ…å«ç¨³å®šä»£ç 
- `develop` - å¼€å‘åˆ†æ”¯ï¼Œç”¨äºæ—¥å¸¸å¼€å‘
- `feature/*` - åŠŸèƒ½åˆ†æ”¯
- `hotfix/*` - ç´§æ€¥ä¿®å¤åˆ†æ”¯

### 2. æäº¤è§„èŒƒ

ä½¿ç”¨è¯­ä¹‰åŒ–æäº¤ä¿¡æ¯ï¼š

```
feat: æ·»åŠ æ–°åŠŸèƒ½
fix: ä¿®å¤ bug
docs: æ›´æ–°æ–‡æ¡£
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„ä»£ç 
test: æ·»åŠ æµ‹è¯•
chore: æ„å»º/å·¥å…·é“¾æ›´æ–°
```

### 3. ç‰ˆæœ¬å·è§„èŒƒ

éµå¾ª [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)ï¼š

- `v1.0.0` - ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢å·
- `v1.0.0-beta.1` - é¢„å‘å¸ƒç‰ˆæœ¬
- `v1.0.0-rc.1` - å€™é€‰ç‰ˆæœ¬

### 4. Release è¯´æ˜æ¨¡æ¿

```markdown
## ğŸ‰ æ–°åŠŸèƒ½
- åŠŸèƒ½ A
- åŠŸèƒ½ B

## ğŸ› Bug ä¿®å¤
- ä¿®å¤é—®é¢˜ 1
- ä¿®å¤é—®é¢˜ 2

## ğŸ“ æ–‡æ¡£æ›´æ–°
- æ›´æ–°å®‰è£…æŒ‡å—
- æ·»åŠ ç¤ºä¾‹

## âš ï¸ ç ´åæ€§å˜æ›´
- å˜æ›´ 1ï¼ˆå¦‚æœæœ‰ï¼‰

## ğŸ”§ å…¶ä»–æ”¹è¿›
- æ€§èƒ½ä¼˜åŒ–
- ä»£ç é‡æ„
```

## ğŸ†˜ æ•…éšœæ’æŸ¥

### CI æ„å»ºå¤±è´¥

1. æŸ¥çœ‹ Actions æ—¥å¿—
2. æ£€æŸ¥ Java ç‰ˆæœ¬æ˜¯å¦æ­£ç¡®ï¼ˆåº”ä¸º 11ï¼‰
3. ç¡®è®¤ Maven é…ç½®æ­£ç¡®
4. éªŒè¯æ‰©å±•ç‚¹ç´¢å¼•æ–‡ä»¶å­˜åœ¨

### Release åˆ›å»ºå¤±è´¥

1. ç¡®è®¤ tag æ ¼å¼æ­£ç¡®ï¼ˆ`v*`ï¼‰
2. æ£€æŸ¥æ˜¯å¦æœ‰æƒé™åˆ›å»º Release
3. éªŒè¯ `GITHUB_TOKEN` æƒé™

### æ„å»ºäº§ç‰©ç¼ºå¤±

1. æ£€æŸ¥ `.gitignore` æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ `target/` ç›®å½•åœ¨ CI ä¸­è¢«åˆ›å»º
3. éªŒè¯ Maven æ‰“åŒ…æ­¥éª¤æˆåŠŸ

## ğŸ“ è·å–å¸®åŠ©

- GitHub Issues: https://github.com/zsjohny/jenkins-scheduled-build-plugin/issues
- GitHub Discussions: https://github.com/zsjohny/jenkins-scheduled-build-plugin/discussions
- Actions æ–‡æ¡£: https://docs.github.com/en/actions

## ğŸ‰ æ€»ç»“

âœ… **å·²å®Œæˆçš„é…ç½®ï¼š**
- CI è‡ªåŠ¨æ„å»º
- PR è‡ªåŠ¨æ£€æŸ¥
- Release è‡ªåŠ¨å‘å¸ƒ
- æ„å»ºäº§ç‰©ä¸Šä¼ 

âœ… **ä¸‹ä¸€æ­¥æ“ä½œï¼š**
1. åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ª PR æµ‹è¯• PR Check
2. Merge PR åæŸ¥çœ‹ CI æ„å»º
3. åˆ›å»º tag æµ‹è¯•è‡ªåŠ¨å‘å¸ƒ
4. ä» Releases ä¸‹è½½å¹¶å®‰è£…æ’ä»¶

ğŸš€ **Happy Coding!**

